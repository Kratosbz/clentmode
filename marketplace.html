<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vaultorx - Discover Rare Digital Art</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root {
            --vx-primary: #22c55e;
            --vx-primary-hover: #16a34a;
            --vx-blue: #3b82f6;
            --vx-dark: #1a1a2e;
            --vx-light: #f8fafc;
            --vx-card-bg: #ffffff;
            --vx-border: #e2e8f0;
            --vx-text: #1e293b;
            --vx-text-muted: #64748b;
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #ffffff;
            color: var(--vx-text);
        }
        
        /* Header */
        .vx-header {
            background: #ffffff;
            border-bottom: 1px solid var(--vx-border);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .vx-header-inner {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 2rem;
        }
        
        .vx-logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--vx-text);
        }
        
        .vx-logo-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .vx-logo-icon svg {
            width: 28px;
            height: 28px;
        }
        
        .vx-search-container {
            flex: 1;
            max-width: 500px;
            position: relative;
        }
        
        .vx-search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.75rem;
            border: 1px solid var(--vx-border);
            border-radius: 8px;
            font-size: 0.95rem;
            background: #f8fafc;
            transition: all 0.2s;
        }
        
        .vx-search-input:focus {
            outline: none;
            border-color: var(--vx-blue);
            background: #fff;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .vx-search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--vx-text-muted);
        }
        
        .vx-search-shortcut {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            background: #fff;
            border: 1px solid var(--vx-border);
            border-radius: 4px;
            padding: 0.15rem 0.4rem;
            font-size: 0.75rem;
            color: var(--vx-text-muted);
            font-family: monospace;
        }
        
        .vx-search-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            margin-top: 0.5rem;
            max-height: 400px;
            overflow-y: auto;
            display: none;
            z-index: 1001;
        }
        
        .vx-search-dropdown.show { display: block; }
        
        .vx-search-result {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: background 0.2s;
            text-decoration: none;
            color: inherit;
        }
        
        .vx-search-result:hover { background: var(--vx-light); }
        
        .vx-search-result img {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
        }
        
        .vx-search-result-info h6 {
            margin: 0;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .vx-search-result-info small {
            color: var(--vx-text-muted);
        }
        
        .vx-search-section-label {
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--vx-text-muted);
            text-transform: uppercase;
            background: var(--vx-light);
            border-bottom: 1px solid var(--vx-border);
        }
        
        .vx-search-result.artist-result {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), transparent);
        }
        
        .vx-search-result.artist-result:hover {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), var(--vx-light));
        }
        
        .vx-artist-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--vx-blue), var(--vx-primary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.25rem;
        }
        
        .vx-header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .vx-btn-login {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: transparent;
            border: none;
            color: var(--vx-text);
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
        }
        
        .vx-btn-login:hover { color: var(--vx-text); }
        
        .vx-btn-signup {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1.25rem;
            background: var(--vx-primary);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            transition: background 0.2s;
        }
        
        .vx-btn-signup:hover {
            background: var(--vx-primary-hover);
            color: white;
        }
        
        /* Hero Section */
        .vx-hero {
            position: relative;
            height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            overflow: hidden;
        }
        
        .vx-hero-bg {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            z-index: 0;
        }
        
        .vx-hero-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('https://images.unsplash.com/photo-1634973357973-f2ed2657db3c?w=1600&auto=format&fit=crop') center/cover;
            opacity: 0.4;
        }
        
        .vx-hero-bg::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.8) 0%, rgba(30, 41, 59, 0.6) 100%);
        }
        
        .vx-hero-content {
            position: relative;
            z-index: 1;
            max-width: 700px;
            padding: 0 1.5rem;
        }
        
        .vx-hero h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            line-height: 1.2;
        }
        
        .vx-hero p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 2rem;
            line-height: 1.6;
        }
        
        .vx-hero-btns {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .vx-btn-outline {
            padding: 0.875rem 1.75rem;
            background: white;
            border: none;
            border-radius: 8px;
            color: var(--vx-text);
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.2s;
        }
        
        .vx-btn-outline:hover {
            background: #f1f5f9;
            color: var(--vx-text);
        }
        
        .vx-btn-green {
            padding: 0.875rem 1.75rem;
            background: var(--vx-primary);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.2s;
        }
        
        .vx-btn-green:hover {
            background: var(--vx-primary-hover);
            color: white;
        }
        
        /* Section Styles */
        .vx-section {
            max-width: 1280px;
            margin: 0 auto;
            padding: 4rem 1.5rem;
        }
        
        .vx-section-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .vx-section-label {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--vx-primary);
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.75rem;
        }
        
        .vx-section-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--vx-text);
        }
        
        .vx-section-title span {
            color: var(--vx-blue);
        }
        
        .vx-section-subtitle {
            color: var(--vx-text-muted);
            font-size: 1.1rem;
            margin-top: 0.75rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Categories Grid */
        .vx-categories-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        @media (max-width: 992px) {
            .vx-categories-grid { grid-template-columns: repeat(2, 1fr); }
        }
        
        @media (max-width: 576px) {
            .vx-categories-grid { grid-template-columns: 1fr; }
        }
        
        .vx-category-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.25rem;
            background: #ffffff;
            border: 1px solid var(--vx-border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            color: inherit;
        }
        
        .vx-category-card:hover {
            border-color: var(--vx-blue);
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transform: translateY(-2px);
        }
        
        .vx-category-card.active {
            border-color: var(--vx-blue);
            background: #f0f9ff;
        }
        
        .vx-category-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .vx-category-icon.blue { background: #dbeafe; color: #3b82f6; }
        .vx-category-icon.pink { background: #fce7f3; color: #ec4899; }
        .vx-category-icon.teal { background: #ccfbf1; color: #14b8a6; }
        .vx-category-icon.red { background: #fee2e2; color: #ef4444; }
        .vx-category-icon.orange { background: #ffedd5; color: #f97316; }
        .vx-category-icon.purple { background: #f3e8ff; color: #a855f7; }
        
        .vx-category-info h6 {
            font-weight: 600;
            margin: 0 0 0.25rem;
            font-size: 1rem;
        }
        
        .vx-category-info small {
            color: var(--vx-text-muted);
            font-size: 0.85rem;
        }
        
        .vx-pagination-dots {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
        }
        
        .vx-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #cbd5e1;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .vx-dot.active {
            background: var(--vx-blue);
            width: 24px;
            border-radius: 4px;
        }
        
        /* Collections Grid */
        .vx-collections-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }
        
        @media (max-width: 992px) {
            .vx-collections-grid { grid-template-columns: repeat(2, 1fr); }
        }
        
        @media (max-width: 576px) {
            .vx-collections-grid { grid-template-columns: 1fr; }
        }
        
        .vx-collection-card {
            background: #ffffff;
            border: 1px solid var(--vx-border);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.2s;
        }
        
        .vx-collection-card:hover {
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
            transform: translateY(-4px);
        }
        
        .vx-collection-images {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 4px;
            height: 200px;
        }
        
        .vx-collection-main-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .vx-collection-side-imgs {
            display: grid;
            grid-template-rows: 1fr 1fr;
            gap: 4px;
        }
        
        .vx-collection-side-imgs img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .vx-collection-content {
            padding: 1.25rem;
        }
        
        .vx-collection-content h5 {
            font-weight: 600;
            margin: 0 0 0.5rem;
        }
        
        .vx-collection-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--vx-text-muted);
            font-size: 0.875rem;
        }
        
        /* NFT Grid */
        .vx-nft-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }
        
        .vx-nft-card {
            background: white;
            border: 1px solid var(--vx-border);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.2s;
            cursor: pointer;
        }
        
        .vx-nft-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.08);
        }
        
        .vx-nft-image-container {
            position: relative;
            padding-top: 100%;
            overflow: hidden;
        }
        
        .vx-nft-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }
        
        .vx-nft-card:hover .vx-nft-image {
            transform: scale(1.05);
        }
        
        .vx-nft-like {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255,255,255,0.95);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            z-index: 10;
            font-size: 1rem;
        }
        
        .vx-nft-like:hover { transform: scale(1.1); }
        .vx-nft-like.liked { background: #ef4444; color: white; }
        
        .vx-likes-count {
            font-size: 0.65rem;
            font-weight: 600;
            margin-top: 1px;
        }
        
        .vx-nft-badge {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: var(--vx-primary);
            color: white;
            padding: 0.35rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .vx-nft-content {
            padding: 1.25rem;
        }
        
        .vx-nft-title {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .vx-nft-creator {
            font-size: 0.85rem;
            color: var(--vx-text-muted);
            margin-bottom: 1rem;
        }
        
        .vx-nft-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid var(--vx-border);
        }
        
        .vx-nft-price {
            font-weight: 700;
            color: var(--vx-text);
        }
        
        .vx-nft-price small {
            font-weight: 400;
            color: var(--vx-text-muted);
            display: block;
            font-size: 0.75rem;
        }
        
        .vx-buy-btn {
            background: var(--vx-blue);
            color: white;
            border: none;
            padding: 0.5rem 1.25rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .vx-buy-btn:hover {
            background: #2563eb;
        }
        
        /* Filter Bar */
        .vx-filter-bar {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: 2rem;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 12px;
        }
        
        .vx-filter-select {
            padding: 0.5rem 1rem;
            border: 1px solid var(--vx-border);
            border-radius: 8px;
            font-size: 0.9rem;
            background: white;
        }
        
        .vx-tabs {
            display: flex;
            gap: 0.25rem;
            margin-bottom: 2rem;
            background: #f1f5f9;
            padding: 0.25rem;
            border-radius: 10px;
            width: fit-content;
        }
        
        .vx-tab {
            padding: 0.625rem 1.25rem;
            border: none;
            background: transparent;
            font-weight: 500;
            color: var(--vx-text-muted);
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
        }
        
        .vx-tab.active {
            background: white;
            color: var(--vx-text);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        /* Auctions */
        .vx-auction-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 1.5rem;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .vx-auction-timer {
            background: rgba(0,0,0,0.2);
            padding: 0.75rem 1rem;
            border-radius: 10px;
            display: inline-flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .vx-timer-item { text-align: center; }
        
        .vx-timer-value {
            font-size: 1.5rem;
            font-weight: 700;
            display: block;
        }
        
        .vx-timer-label {
            font-size: 0.7rem;
            opacity: 0.8;
            text-transform: uppercase;
        }
        
        /* Exhibitions */
        .vx-exhibition-card {
            background: white;
            border: 1px solid var(--vx-border);
            border-radius: 16px;
            overflow: hidden;
        }
        
        .vx-exhibition-image {
            height: 200px;
            object-fit: cover;
            width: 100%;
        }
        
        .vx-exhibition-content {
            padding: 1.5rem;
        }
        
        /* Footer */
        .vx-footer {
            background: var(--vx-dark);
            color: white;
            padding: 3rem 0;
            margin-top: 4rem;
        }
        
        .vx-footer a {
            color: rgba(255,255,255,0.7);
            text-decoration: none;
            margin-right: 1.5rem;
        }
        
        .vx-footer a:hover { color: white; }
        
        /* Modal */
        .vx-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 1rem;
        }
        
        .vx-modal {
            background: white;
            border-radius: 20px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .vx-modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--vx-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .vx-modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--vx-text-muted);
        }
        
        .vx-modal-body { padding: 1.5rem; }
        
        .vx-artwork-detail {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        @media (max-width: 768px) {
            .vx-artwork-detail { grid-template-columns: 1fr; }
            .vx-hero h1 { font-size: 2rem; }
            .vx-section-title { font-size: 1.75rem; }
            .vx-header-inner { flex-wrap: wrap; }
            .vx-search-container { order: 3; flex: 0 0 100%; margin-top: 1rem; max-width: 100%; }
        }
        
        .vx-artwork-image {
            width: 100%;
            border-radius: 12px;
            object-fit: cover;
        }
        
        .vx-artwork-info h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .vx-creator-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--vx-light);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            margin-bottom: 1rem;
        }
        
        .vx-creator-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--vx-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .vx-price-box {
            background: var(--vx-light);
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1.5rem 0;
        }
        
        .vx-price-label {
            font-size: 0.85rem;
            color: var(--vx-text-muted);
            margin-bottom: 0.25rem;
        }
        
        .vx-price-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--vx-text);
        }
        
        .vx-action-btns {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .vx-action-btn {
            flex: 1;
            padding: 1rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .vx-action-btn.primary {
            background: var(--vx-blue);
            color: white;
        }
        
        .vx-action-btn.primary:hover { background: #2563eb; }
        
        .vx-share-link {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .vx-share-link input {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid var(--vx-border);
            border-radius: 8px;
            font-size: 0.85rem;
        }
        
        .vx-empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--vx-text-muted);
        }
        
        .vx-empty-state i {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }
        
        .vx-btn-all-categories {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: white;
            border: 1px solid var(--vx-border);
            border-radius: 8px;
            color: var(--vx-text);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }
        
        .vx-btn-all-categories:hover {
            border-color: var(--vx-blue);
            color: var(--vx-blue);
        }
        
        /* Carousel Styles */
        .vx-carousel-container {
            position: relative;
            width: 100%;
            overflow: hidden;
            margin: 2rem 0;
            padding: 0 3rem;
        }
        
        .vx-carousel-track {
            display: flex;
            gap: 1rem;
            transition: transform 0.5s ease-in-out;
            will-change: transform;
        }
        
        .vx-carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            border: 1px solid var(--vx-border);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .vx-carousel-btn:hover {
            background: var(--vx-primary);
            color: white;
            border-color: var(--vx-primary);
        }
        
        .vx-carousel-prev { left: 0; }
        .vx-carousel-next { right: 0; }
        
        .vx-carousel-card {
            flex: 0 0 220px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--vx-border);
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .vx-carousel-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        }
        
        .vx-carousel-card-img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }
        
        .vx-carousel-card-body {
            padding: 1rem;
        }
        
        .vx-carousel-card-title {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .vx-carousel-card-artist {
            font-size: 0.8rem;
            color: var(--vx-text-muted);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .vx-carousel-card-price {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--vx-primary);
            margin-top: 0.5rem;
        }
        
        .vx-carousel-card-category {
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 500;
        }
        
        .vx-carousel-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 3rem;
            color: var(--vx-text-muted);
            gap: 0.5rem;
        }
        
        @media (max-width: 768px) {
            .vx-carousel-container { padding: 0 2.5rem; }
            .vx-carousel-card { flex: 0 0 180px; }
            .vx-carousel-card-img { height: 140px; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="vx-header">
        <div class="vx-header-inner">
            <a href="/marketplace.html" class="vx-logo">
                <div class="vx-logo-icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="#1e293b"/>
                        <path d="M2 17L12 22L22 17" stroke="#1e293b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M2 12L12 17L22 12" stroke="#1e293b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                VAULTORX
            </a>
            
            <div class="vx-search-container">
                <i class="bi bi-search vx-search-icon"></i>
                <input type="text" class="vx-search-input" id="searchInput" placeholder="Search collections, NFTs, creators...">
                <span class="vx-search-shortcut">âŒ˜K</span>
                <div class="vx-search-dropdown" id="searchDropdown"></div>
            </div>
            
            <div class="vx-header-actions">
                <a href="support.html" class="vx-btn-login" data-testid="link-support">
                    <i class="bi bi-question-circle"></i>
                    Support
                </a>
                <a href="/dashboard.html" class="vx-btn-login" data-testid="link-login">
                    <i class="bi bi-box-arrow-in-right"></i>
                    Login
                </a>
                <a href="/dashboard.html" class="vx-btn-signup" data-testid="link-signup">
                    <i class="bi bi-person-plus"></i>
                    Sign Up
                </a>
            </div>
        </div>
    </header>
    
    <!-- Hero Section -->
    <section class="vx-hero">
        <div class="vx-hero-bg"></div>
        <div class="vx-hero-content">
            <h1>Discover Rare Digital Art</h1>
            <p>Explore, collect, and trade exclusive NFTs from emerging artists and established creators</p>
            <div class="vx-hero-btns">
                <a href="#marketplace" class="vx-btn-outline">Explore Marketplace</a>
                <a href="#collections" class="vx-btn-green">View Collections</a>
            </div>
        </div>
    </section>
    
    <!-- Explore by Category -->
    <section class="vx-section" id="categories">
        <h2 class="vx-section-title" style="text-align: center; margin-bottom: 2rem;">Explore by Category</h2>
        
        <div class="vx-categories-grid" id="categoriesContainer">
            <div class="vx-category-card active" data-category="all">
                <div class="vx-category-icon blue"><i class="bi bi-grid-3x3-gap-fill"></i></div>
                <div class="vx-category-info">
                    <h6>All Categories</h6>
                    <small>Browse everything</small>
                </div>
            </div>
            <div class="vx-category-card" data-category="Gaming">
                <div class="vx-category-icon blue"><i class="bi bi-controller"></i></div>
                <div class="vx-category-info">
                    <h6>Gaming</h6>
                    <small>Game assets & collectibles</small>
                </div>
            </div>
            <div class="vx-category-card" data-category="Art">
                <div class="vx-category-icon pink"><i class="bi bi-palette-fill"></i></div>
                <div class="vx-category-info">
                    <h6>Digital Art</h6>
                    <small>Creative digital artwork</small>
                </div>
            </div>
            <div class="vx-category-card" data-category="Photography">
                <div class="vx-category-icon teal"><i class="bi bi-camera-fill"></i></div>
                <div class="vx-category-info">
                    <h6>Photography</h6>
                    <small>Photographic NFTs</small>
                </div>
            </div>
            <div class="vx-category-card" data-category="Music">
                <div class="vx-category-icon red"><i class="bi bi-music-note-beamed"></i></div>
                <div class="vx-category-info">
                    <h6>Music</h6>
                    <small>Audio & music NFTs</small>
                </div>
            </div>
            <div class="vx-category-card" data-category="Sports">
                <div class="vx-category-icon orange"><i class="bi bi-trophy-fill"></i></div>
                <div class="vx-category-info">
                    <h6>Sports</h6>
                    <small>Sports memorabilia</small>
                </div>
            </div>
            <div class="vx-category-card" data-category="Fashion">
                <div class="vx-category-icon pink"><i class="bi bi-handbag-fill"></i></div>
                <div class="vx-category-info">
                    <h6>Fashion</h6>
                    <small>Digital fashion</small>
                </div>
            </div>
            <div class="vx-category-card" data-category="3D Art">
                <div class="vx-category-icon blue"><i class="bi bi-box"></i></div>
                <div class="vx-category-info">
                    <h6>3D Art</h6>
                    <small>3D models & sculptures</small>
                </div>
            </div>
            <div class="vx-category-card" data-category="Video">
                <div class="vx-category-icon purple"><i class="bi bi-play-circle-fill"></i></div>
                <div class="vx-category-info">
                    <h6>Animated</h6>
                    <small>Animated artworks</small>
                </div>
            </div>
        </div>
        
        <div class="vx-pagination-dots">
            <span class="vx-dot"></span>
            <span class="vx-dot"></span>
            <span class="vx-dot"></span>
            <span class="vx-dot"></span>
            <span class="vx-dot"></span>
            <span class="vx-dot active"></span>
            <span class="vx-dot"></span>
            <span class="vx-dot"></span>
        </div>
    </section>
    
    <!-- Featured Drops -->
    <section class="vx-section" id="collections" style="background: #f8fafc; margin: 0; max-width: 100%; padding-left: calc((100% - 1280px) / 2 + 1.5rem); padding-right: calc((100% - 1280px) / 2 + 1.5rem);">
        <div class="vx-section-header">
            <div class="vx-section-label">
                <i class="bi bi-lightning-charge-fill"></i>
                TRENDING COLLECTIONS
            </div>
            <h2 class="vx-section-title">Featured <span>Drops</span></h2>
            <p class="vx-section-subtitle">Curated selection of this week's most promising NFT collections</p>
        </div>
        
        <!-- Featured Drops Carousel -->
        <div class="vx-carousel-container" id="featuredDropsCarousel">
            <button class="vx-carousel-btn vx-carousel-prev" onclick="slideFeaturedDrops(-1)" data-testid="button-featured-prev">
                <i class="bi bi-chevron-left"></i>
            </button>
            <div class="vx-carousel-track" id="featuredDropsTrack">
                <div class="vx-carousel-loading">
                    <i class="bi bi-hourglass-split"></i> Loading featured drops...
                </div>
            </div>
            <button class="vx-carousel-btn vx-carousel-next" onclick="slideFeaturedDrops(1)" data-testid="button-featured-next">
                <i class="bi bi-chevron-right"></i>
            </button>
        </div>
        
        <div class="text-center mb-4">
            <a href="#marketplace" class="vx-btn-outline" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                View All Collections <i class="bi bi-arrow-right"></i>
            </a>
        </div>
    </section>
    
    <!-- Explore Categories Section -->
    <section class="vx-section">
        <div class="vx-section-header">
            <div class="vx-section-label">
                <i class="bi bi-lightning-charge-fill"></i>
                TRENDING BY CATEGORY
            </div>
            <h2 class="vx-section-title">Explore <span>Categories</span></h2>
            <p class="vx-section-subtitle">Discover trending NFTs across different categories and find your next digital asset</p>
        </div>
        
        <!-- Categories Art Carousel -->
        <div class="vx-carousel-container" id="categoriesCarousel">
            <button class="vx-carousel-btn vx-carousel-prev" onclick="slideCategoryArt(-1)" data-testid="button-category-prev">
                <i class="bi bi-chevron-left"></i>
            </button>
            <div class="vx-carousel-track" id="categoriesArtTrack">
                <div class="vx-carousel-loading">
                    <i class="bi bi-hourglass-split"></i> Loading category art...
                </div>
            </div>
            <button class="vx-carousel-btn vx-carousel-next" onclick="slideCategoryArt(1)" data-testid="button-category-next">
                <i class="bi bi-chevron-right"></i>
            </button>
        </div>
        
        <div class="text-center">
            <a href="#categories" class="vx-btn-all-categories">
                <i class="bi bi-lightning-charge"></i>
                All Categories
            </a>
        </div>
    </section>
    
    <!-- Marketplace Section -->
    <section class="vx-section" id="marketplace">
        <h2 class="vx-section-title" style="margin-bottom: 2rem;">
            <span><i class="bi bi-shop me-2"></i></span>Marketplace
        </h2>
        
        <div class="vx-tabs">
            <button class="vx-tab active" data-tab="all">All Items</button>
            <button class="vx-tab" data-tab="listed">For Sale</button>
            <button class="vx-tab" data-tab="auction">Auctions</button>
        </div>
        
        <div class="vx-filter-bar">
            <select class="vx-filter-select" id="sortFilter">
                <option value="newest">Newest First</option>
                <option value="oldest">Oldest First</option>
                <option value="price-low">Price: Low to High</option>
                <option value="price-high">Price: High to Low</option>
                <option value="likes">Most Liked</option>
            </select>
            <select class="vx-filter-select" id="priceFilter">
                <option value="">All Prices</option>
                <option value="0-1">Under 1 ETH</option>
                <option value="1-5">1 - 5 ETH</option>
                <option value="5-10">5 - 10 ETH</option>
                <option value="10+">10+ ETH</option>
            </select>
        </div>
        
        <div class="vx-nft-grid" id="nftGrid">
            <div class="vx-empty-state" style="grid-column: 1 / -1;">
                <i class="bi bi-image"></i>
                <h4>Loading artworks...</h4>
            </div>
        </div>
    </section>
    
    <!-- Live Auctions -->
    <section class="vx-section" id="auctions">
        <h3 class="vx-section-title" style="font-size: 1.5rem; margin-bottom: 1.5rem;">
            <span><i class="bi bi-lightning-charge me-2"></i>Live Auctions</span>
        </h3>
        <div class="row g-4" id="auctionsGrid"></div>
    </section>
    
    <!-- Exhibitions -->
    <section class="vx-section" id="exhibitions">
        <h3 class="vx-section-title" style="font-size: 1.5rem; margin-bottom: 1.5rem;">
            <span><i class="bi bi-building me-2"></i>Exhibitions</span>
        </h3>
        <div class="row g-4" id="exhibitionsGrid"></div>
    </section>
    
    <!-- Footer -->
    <footer class="vx-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h4 class="mb-3" style="display: flex; align-items: center; gap: 0.5rem;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="white"/>
                            <path d="M2 17L12 22L22 17" stroke="white" stroke-width="2" stroke-linecap="round"/>
                            <path d="M2 12L12 17L22 12" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        VAULTORX
                    </h4>
                    <p class="text-white-50">The premier NFT marketplace for digital art collectors and creators.</p>
                </div>
                <div class="col-md-4 mb-4">
                    <h6 class="mb-3">Quick Links</h6>
                    <div>
                        <a href="/marketplace.html">Explore</a>
                        <a href="/dashboard.html">Dashboard</a>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <h6 class="mb-3">Community</h6>
                    <div>
                        <a href="#"><i class="bi bi-twitter me-1"></i>Twitter</a>
                        <a href="#"><i class="bi bi-discord me-1"></i>Discord</a>
                    </div>
                </div>
            </div>
            <hr class="border-secondary">
            <p class="text-white-50 mb-0 text-center">2024 Vaultorx. All rights reserved.</p>
        </div>
    </footer>
    
    <!-- Artwork Modal -->
    <div class="vx-modal-overlay" id="artworkModal">
        <div class="vx-modal">
            <div class="vx-modal-header">
                <h5 class="mb-0">Artwork Details</h5>
                <button class="vx-modal-close" onclick="closeArtworkModal()">&times;</button>
            </div>
            <div class="vx-modal-body">
                <div class="vx-artwork-detail">
                    <div>
                        <img src="" alt="" class="vx-artwork-image" id="modalArtworkImage">
                    </div>
                    <div class="vx-artwork-info">
                        <h2 id="modalArtworkName"></h2>
                        <div class="vx-creator-badge">
                            <div class="vx-creator-avatar" id="modalCreatorAvatar"></div>
                            <span id="modalCreatorName"></span>
                        </div>
                        <p class="text-muted" id="modalArtworkDescription"></p>
                        
                        <div class="d-flex gap-3 mb-3">
                            <span class="badge bg-light text-dark" id="modalCategory"></span>
                            <span class="badge bg-light text-dark" id="modalRarity"></span>
                        </div>
                        
                        <div class="vx-price-box">
                            <div class="vx-price-label">Current Price</div>
                            <div class="vx-price-value" id="modalPrice"></div>
                        </div>
                        
                        <div class="d-flex align-items-center gap-3 mb-3">
                            <button class="btn btn-outline-danger rounded-pill" id="modalLikeBtn" onclick="toggleModalLike()">
                                <i class="bi bi-heart me-1"></i> <span id="modalLikeCount">0</span>
                            </button>
                            <span class="text-muted"><i class="bi bi-eye me-1"></i> <span id="modalViews">0</span> views</span>
                        </div>
                        
                        <div class="vx-action-btns" id="modalActionBtns"></div>
                        
                        <div class="vx-share-link">
                            <input type="text" id="shareLink" readonly>
                            <button class="btn btn-outline-secondary" onclick="copyShareLink()">
                                <i class="bi bi-copy"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let allNFTs = [];
        let allAuctions = [];
        let allExhibitions = [];
        let currentCategory = 'all';
        let currentTab = 'all';
        let currentNFT = null;
        let likedNFTs = JSON.parse(localStorage.getItem('likedNFTs') || '[]');
        let searchTimeout = null;
        
        // Carousel state
        let featuredDropsIndex = 0;
        let categoryArtIndex = 0;
        let featuredDropsItems = [];
        let categoryArtItems = [];
        let featuredDropsAutoSlide = null;
        let categoryArtAutoSlide = null;
        const CAROUSEL_INTERVAL = 4000; // Auto-slide every 4 seconds
        
        document.addEventListener('DOMContentLoaded', () => {
            loadMarketplaceData();
            setupEventListeners();
            checkURLForArtwork();
            loadCarousels();
        });
        
        function setupEventListeners() {
            document.querySelectorAll('.vx-category-card').forEach(card => {
                card.addEventListener('click', () => {
                    const category = card.dataset.category;
                    if (category === 'all') {
                        window.location.href = 'category.html';
                    } else {
                        window.location.href = `category.html?category=${encodeURIComponent(category)}`;
                    }
                });
            });
            
            document.querySelectorAll('.vx-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.vx-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentTab = tab.dataset.tab;
                    filterAndRenderNFTs();
                });
            });
            
            document.getElementById('sortFilter').addEventListener('change', filterAndRenderNFTs);
            document.getElementById('priceFilter').addEventListener('change', filterAndRenderNFTs);
            
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => performSearch(e.target.value), 300);
            });
            
            searchInput.addEventListener('focus', () => {
                if (searchInput.value.length >= 2) {
                    document.getElementById('searchDropdown').classList.add('show');
                }
            });
            
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.vx-search-container')) {
                    document.getElementById('searchDropdown').classList.remove('show');
                }
            });
            
            document.addEventListener('keydown', (e) => {
                if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('searchInput').focus();
                }
            });
            
            // Pause carousel on hover
            const featuredCarousel = document.getElementById('featuredDropsCarousel');
            const categoryCarousel = document.getElementById('categoriesCarousel');
            
            if (featuredCarousel) {
                featuredCarousel.addEventListener('mouseenter', () => clearInterval(featuredDropsAutoSlide));
                featuredCarousel.addEventListener('mouseleave', startFeaturedDropsAutoSlide);
            }
            
            if (categoryCarousel) {
                categoryCarousel.addEventListener('mouseenter', () => clearInterval(categoryArtAutoSlide));
                categoryCarousel.addEventListener('mouseleave', startCategoryArtAutoSlide);
                categoryCarousel.addEventListener('focusin', () => clearInterval(categoryArtAutoSlide));
                categoryCarousel.addEventListener('focusout', startCategoryArtAutoSlide);
            }
            
            // Also pause featured carousel on focus
            if (featuredCarousel) {
                featuredCarousel.addEventListener('focusin', () => clearInterval(featuredDropsAutoSlide));
                featuredCarousel.addEventListener('focusout', startFeaturedDropsAutoSlide);
            }
        }
        
        // Carousel Functions
        async function loadCarousels() {
            try {
                const res = await fetch('/api/marketplace/nfts');
                if (!res.ok) throw new Error('Failed to load NFTs');
                const nfts = await res.json();
                
                // Featured Drops - random 10 NFTs
                featuredDropsItems = shuffleArray([...nfts]).slice(0, 10);
                renderFeaturedDropsCarousel();
                startFeaturedDropsAutoSlide();
                
                // Categories Art - one random NFT per category
                const categories = ['Art', 'Gaming', 'Music', 'Photography', 'Sports', '3D Art', 'Video'];
                categoryArtItems = [];
                categories.forEach(cat => {
                    const catNFTs = nfts.filter(n => n.category === cat);
                    if (catNFTs.length > 0) {
                        const randomNFT = catNFTs[Math.floor(Math.random() * catNFTs.length)];
                        categoryArtItems.push({ ...randomNFT, displayCategory: cat });
                    }
                });
                renderCategoryArtCarousel();
                startCategoryArtAutoSlide();
            } catch (err) {
                console.error('Failed to load carousels:', err);
                document.getElementById('featuredDropsTrack').innerHTML = '<div class="vx-carousel-loading">No featured drops available</div>';
                document.getElementById('categoriesArtTrack').innerHTML = '<div class="vx-carousel-loading">No category art available</div>';
            }
        }
        
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        function renderFeaturedDropsCarousel() {
            const track = document.getElementById('featuredDropsTrack');
            if (!track || featuredDropsItems.length === 0) {
                track.innerHTML = '<div class="vx-carousel-loading">No featured drops available</div>';
                return;
            }
            
            track.innerHTML = featuredDropsItems.map(nft => `
                <div class="vx-carousel-card" onclick="window.location.href='artwork.html?id=${nft._id}'" data-testid="card-featured-${nft._id}">
                    <img src="${nft.imageUrl || '/placeholder-nft.svg'}" alt="${nft.name}" class="vx-carousel-card-img" loading="lazy">
                    <div class="vx-carousel-card-body">
                        <div class="vx-carousel-card-title">${nft.name}</div>
                        <div class="vx-carousel-card-artist">by ${nft.creator || 'Unknown Artist'}</div>
                        <div class="vx-carousel-card-price">${nft.price || 0} ETH</div>
                    </div>
                </div>
            `).join('');
            
            updateCarouselPosition('featured');
        }
        
        function renderCategoryArtCarousel() {
            const track = document.getElementById('categoriesArtTrack');
            if (!track || categoryArtItems.length === 0) {
                track.innerHTML = '<div class="vx-carousel-loading">No category art available</div>';
                return;
            }
            
            track.innerHTML = categoryArtItems.map(nft => `
                <div class="vx-carousel-card" style="position: relative;" onclick="window.location.href='category.html?category=${encodeURIComponent(nft.displayCategory)}'" data-testid="card-category-${nft.displayCategory}">
                    <div class="vx-carousel-card-category">${nft.displayCategory}</div>
                    <img src="${nft.imageUrl || '/placeholder-nft.svg'}" alt="${nft.name}" class="vx-carousel-card-img" loading="lazy">
                    <div class="vx-carousel-card-body">
                        <div class="vx-carousel-card-title">${nft.name}</div>
                        <div class="vx-carousel-card-artist">by ${nft.creator || 'Unknown Artist'}</div>
                        <div class="vx-carousel-card-price">${nft.price || 0} ETH</div>
                    </div>
                </div>
            `).join('');
            
            updateCarouselPosition('category');
        }
        
        function slideFeaturedDrops(direction) {
            const totalItems = featuredDropsItems.length;
            if (totalItems === 0) return;
            
            featuredDropsIndex += direction;
            if (featuredDropsIndex < 0) featuredDropsIndex = totalItems - 1;
            if (featuredDropsIndex >= totalItems) featuredDropsIndex = 0;
            
            updateCarouselPosition('featured');
        }
        
        function slideCategoryArt(direction) {
            const totalItems = categoryArtItems.length;
            if (totalItems === 0) return;
            
            categoryArtIndex += direction;
            if (categoryArtIndex < 0) categoryArtIndex = totalItems - 1;
            if (categoryArtIndex >= totalItems) categoryArtIndex = 0;
            
            updateCarouselPosition('category');
        }
        
        function getCardWidth(trackId) {
            const track = document.getElementById(trackId);
            if (!track) return 236; // fallback
            const firstCard = track.querySelector('.vx-carousel-card');
            if (!firstCard) return 236;
            // Get computed width including gap
            const style = window.getComputedStyle(track);
            const gap = parseInt(style.gap) || 16;
            return firstCard.offsetWidth + gap;
        }
        
        function updateCarouselPosition(type) {
            if (type === 'featured') {
                const track = document.getElementById('featuredDropsTrack');
                if (track) {
                    const cardWidth = getCardWidth('featuredDropsTrack');
                    track.style.transform = `translateX(-${featuredDropsIndex * cardWidth}px)`;
                }
            } else if (type === 'category') {
                const track = document.getElementById('categoriesArtTrack');
                if (track) {
                    const cardWidth = getCardWidth('categoriesArtTrack');
                    track.style.transform = `translateX(-${categoryArtIndex * cardWidth}px)`;
                }
            }
        }
        
        // Handle window resize to recalculate carousel positions
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                updateCarouselPosition('featured');
                updateCarouselPosition('category');
            }, 100);
        });
        
        function startFeaturedDropsAutoSlide() {
            clearInterval(featuredDropsAutoSlide);
            featuredDropsAutoSlide = setInterval(() => {
                slideFeaturedDrops(1);
            }, CAROUSEL_INTERVAL);
        }
        
        function startCategoryArtAutoSlide() {
            clearInterval(categoryArtAutoSlide);
            categoryArtAutoSlide = setInterval(() => {
                slideCategoryArt(1);
            }, CAROUSEL_INTERVAL);
        }
        
        async function loadMarketplaceData() {
            try {
                const [nftsRes, auctionsRes, exhibitionsRes] = await Promise.all([
                    fetch('/api/marketplace/nfts'),
                    fetch('/api/marketplace/auctions'),
                    fetch('/api/marketplace/exhibitions')
                ]);
                
                if (nftsRes.ok) allNFTs = await nftsRes.json();
                if (auctionsRes.ok) allAuctions = await auctionsRes.json();
                if (exhibitionsRes.ok) allExhibitions = await exhibitionsRes.json();
                
                filterAndRenderNFTs();
                renderAuctions();
                renderExhibitions();
            } catch (err) {
                console.error('Failed to load marketplace data:', err);
            }
        }
        
        function filterAndRenderNFTs() {
            let filtered = [...allNFTs];
            
            if (currentCategory !== 'all') {
                filtered = filtered.filter(n => n.category === currentCategory);
            }
            
            if (currentTab === 'listed') {
                filtered = filtered.filter(n => n.status === 'listed');
            } else if (currentTab === 'auction') {
                filtered = filtered.filter(n => n.status === 'auction');
            }
            
            const priceFilter = document.getElementById('priceFilter').value;
            if (priceFilter) {
                if (priceFilter === '10+') {
                    filtered = filtered.filter(n => (n.price || 0) >= 10);
                } else {
                    const [min, max] = priceFilter.split('-').map(Number);
                    filtered = filtered.filter(n => {
                        const price = n.price || 0;
                        return price >= min && price < max;
                    });
                }
            }
            
            const sortFilter = document.getElementById('sortFilter').value;
            switch (sortFilter) {
                case 'oldest':
                    filtered.sort((a, b) => new Date(a.createdAt) - new Date(b.createdAt));
                    break;
                case 'price-low':
                    filtered.sort((a, b) => (a.price || 0) - (b.price || 0));
                    break;
                case 'price-high':
                    filtered.sort((a, b) => (b.price || 0) - (a.price || 0));
                    break;
                case 'likes':
                    filtered.sort((a, b) => (b.likes || 0) - (a.likes || 0));
                    break;
                default:
                    filtered.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            }
            
            renderNFTGrid(filtered);
        }
        
        function renderNFTGrid(nfts) {
            const grid = document.getElementById('nftGrid');
            
            if (nfts.length === 0) {
                grid.innerHTML = `
                    <div class="vx-empty-state" style="grid-column: 1 / -1;">
                        <i class="bi bi-image"></i>
                        <h4>No artworks found</h4>
                        <p>Try adjusting your filters or search criteria</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = nfts.map(nft => {
                const isLiked = likedNFTs.includes(nft._id);
                const statusBadge = nft.status === 'auction' ? 'Auction' : 
                                   nft.status === 'listed' ? 'For Sale' : '';
                
                return `
                    <a href="artwork.html?id=${nft._id}" class="vx-nft-card" data-testid="card-nft-${nft._id}" style="text-decoration: none; color: inherit; display: block;">
                        <div class="vx-nft-image-container">
                            <img src="${nft.imageUrl}" alt="${nft.name}" class="vx-nft-image">
                            ${statusBadge ? `<span class="vx-nft-badge">${statusBadge}</span>` : ''}
                            <button class="vx-nft-like ${isLiked ? 'liked' : ''}" onclick="event.preventDefault(); event.stopPropagation(); toggleLike('${nft._id}')" data-testid="button-like-${nft._id}">
                                <i class="bi bi-heart${isLiked ? '-fill' : ''}"></i>
                                <div class="vx-likes-count">${nft.likes || 0}</div>
                            </button>
                        </div>
                        <div class="vx-nft-content">
                            <h6 class="vx-nft-title">${nft.name}</h6>
                            <p class="vx-nft-creator">by ${nft.creator || 'Unknown'}</p>
                            <div class="vx-nft-footer">
                                <div class="vx-nft-price">
                                    ${nft.price ? nft.price.toFixed(2) + ' ' + (nft.currency || 'ETH') : 'Not listed'}
                                    <small>Current Price</small>
                                </div>
                            </div>
                        </div>
                    </a>
                `;
            }).join('');
        }
        
        function renderAuctions() {
            const grid = document.getElementById('auctionsGrid');
            const activeAuctions = allAuctions.filter(a => {
                const now = new Date();
                return new Date(a.startTime) <= now && new Date(a.endTime) > now;
            });
            
            if (activeAuctions.length === 0) {
                grid.innerHTML = '<div class="col-12 text-center text-muted py-4">No live auctions at the moment</div>';
                return;
            }
            
            grid.innerHTML = activeAuctions.slice(0, 4).map(auction => {
                const endTime = new Date(auction.endTime);
                const timeLeft = getTimeLeft(endTime);
                
                return `
                    <div class="col-md-6 col-lg-3">
                        <div class="vx-auction-card">
                            <div class="vx-auction-timer">
                                <div class="vx-timer-item">
                                    <span class="vx-timer-value">${timeLeft.hours}</span>
                                    <span class="vx-timer-label">Hours</span>
                                </div>
                                <div class="vx-timer-item">
                                    <span class="vx-timer-value">${timeLeft.minutes}</span>
                                    <span class="vx-timer-label">Mins</span>
                                </div>
                                <div class="vx-timer-item">
                                    <span class="vx-timer-value">${timeLeft.seconds}</span>
                                    <span class="vx-timer-label">Secs</span>
                                </div>
                            </div>
                            <h5 class="fw-bold mb-2">${auction.title || 'Untitled Auction'}</h5>
                            <p class="opacity-75 mb-3">Current Bid: ${auction.currentBid || auction.startingPrice} ETH</p>
                            <button class="btn btn-light btn-sm rounded-pill px-4" onclick="openAuctionDetail('${auction._id}')" data-testid="button-bid-${auction._id}">Place Bid</button>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function renderExhibitions() {
            const grid = document.getElementById('exhibitionsGrid');
            
            if (allExhibitions.length === 0) {
                grid.innerHTML = '<div class="col-12 text-center text-muted py-4">No exhibitions available</div>';
                return;
            }
            
            grid.innerHTML = allExhibitions.slice(0, 3).map(exhibition => `
                <div class="col-md-4">
                    <div class="vx-exhibition-card">
                        <img src="${exhibition.imageUrl || 'https://via.placeholder.com/400x200?text=Exhibition'}" 
                             alt="${exhibition.name}" class="vx-exhibition-image">
                        <div class="vx-exhibition-content">
                            <span class="badge bg-primary mb-2">${exhibition.type || 'Virtual'}</span>
                            <h5 class="fw-bold">${exhibition.name}</h5>
                            <p class="text-muted small mb-3">${exhibition.description || 'No description'}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <small class="text-muted">
                                    <i class="bi bi-calendar me-1"></i>
                                    ${new Date(exhibition.startDate).toLocaleDateString()}
                                </small>
                                <button class="btn btn-sm btn-outline-primary rounded-pill" data-testid="button-view-exhibition-${exhibition._id}">View</button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function getTimeLeft(endTime) {
            const now = new Date();
            const diff = Math.max(0, endTime - now);
            
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            return {
                hours: String(hours).padStart(2, '0'),
                minutes: String(minutes).padStart(2, '0'),
                seconds: String(seconds).padStart(2, '0')
            };
        }
        
        async function performSearch(query) {
            const dropdown = document.getElementById('searchDropdown');
            
            if (query.length < 2) {
                dropdown.classList.remove('show');
                return;
            }
            
            try {
                const res = await fetch(`/api/marketplace/search?q=${encodeURIComponent(query)}`);
                if (!res.ok) throw new Error('Search failed');
                
                const results = await res.json();
                
                if (results.length === 0) {
                    dropdown.innerHTML = '<div class="p-3 text-muted text-center">No results found</div>';
                } else {
                    // Extract unique artists from results
                    const uniqueArtists = [...new Set(results.map(nft => nft.creator).filter(Boolean))];
                    const queryLower = query.toLowerCase();
                    const matchingArtists = uniqueArtists.filter(artist => 
                        artist.toLowerCase().includes(queryLower)
                    ).slice(0, 3);
                    
                    let html = '';
                    
                    // Show matching artists first
                    if (matchingArtists.length > 0) {
                        html += '<div class="vx-search-section-label">Artists</div>';
                        html += matchingArtists.map(artist => `
                            <a href="artist.html?name=${encodeURIComponent(artist)}" class="vx-search-result artist-result" data-testid="search-artist-${artist}">
                                <div class="vx-artist-avatar">${artist.charAt(0).toUpperCase()}</div>
                                <div class="vx-search-result-info">
                                    <h6>${artist}</h6>
                                    <small>Artist Profile</small>
                                </div>
                            </a>
                        `).join('');
                    }
                    
                    // Show NFTs
                    html += '<div class="vx-search-section-label">Artworks</div>';
                    html += results.slice(0, 6).map(nft => `
                        <a href="artwork.html?id=${nft._id}" class="vx-search-result" data-testid="search-result-${nft._id}">
                            <img src="${nft.imageUrl}" alt="${nft.name}">
                            <div class="vx-search-result-info">
                                <h6>${nft.name}</h6>
                                <small>by ${nft.creator || 'Unknown'} - ${nft.category}</small>
                            </div>
                        </a>
                    `).join('');
                    
                    dropdown.innerHTML = html;
                }
                
                dropdown.classList.add('show');
            } catch (err) {
                console.error('Search error:', err);
            }
        }
        
        async function toggleLike(nftId) {
            const isLiked = likedNFTs.includes(nftId);
            
            if (isLiked) {
                likedNFTs = likedNFTs.filter(id => id !== nftId);
            } else {
                likedNFTs.push(nftId);
            }
            localStorage.setItem('likedNFTs', JSON.stringify(likedNFTs));
            
            const nft = allNFTs.find(n => n._id === nftId);
            if (nft) {
                nft.likes = isLiked ? Math.max(0, (nft.likes || 0) - 1) : (nft.likes || 0) + 1;
            }
            
            filterAndRenderNFTs();
            
            try {
                await fetch(`/api/marketplace/nfts/${nftId}/like`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ unlike: isLiked })
                });
            } catch (err) {
                console.error('Like sync error:', err);
            }
        }
        
        function openArtworkModal(nftId) {
            currentNFT = allNFTs.find(n => n._id === nftId);
            if (!currentNFT) return;
            
            window.history.pushState({}, '', `/marketplace?nft=${nftId}`);
            
            incrementViews(nftId);
            
            document.getElementById('modalArtworkImage').src = currentNFT.imageUrl;
            document.getElementById('modalArtworkName').textContent = currentNFT.name;
            document.getElementById('modalCreatorAvatar').textContent = (currentNFT.creator || 'U')[0].toUpperCase();
            document.getElementById('modalCreatorName').textContent = currentNFT.creator || 'Unknown Artist';
            document.getElementById('modalArtworkDescription').textContent = currentNFT.description || 'No description available';
            document.getElementById('modalCategory').textContent = currentNFT.category || 'Art';
            document.getElementById('modalRarity').textContent = currentNFT.rarity || 'Common';
            document.getElementById('modalPrice').textContent = currentNFT.price ? 
                `${currentNFT.price.toFixed(2)} ${currentNFT.currency || 'ETH'}` : 'Not for sale';
            document.getElementById('modalLikeCount').textContent = currentNFT.likes || 0;
            document.getElementById('modalViews').textContent = currentNFT.views || 0;
            
            const isLiked = likedNFTs.includes(nftId);
            const likeBtn = document.getElementById('modalLikeBtn');
            likeBtn.innerHTML = `<i class="bi bi-heart${isLiked ? '-fill' : ''} me-1"></i> <span id="modalLikeCount">${currentNFT.likes || 0}</span>`;
            likeBtn.classList.toggle('btn-danger', isLiked);
            likeBtn.classList.toggle('btn-outline-danger', !isLiked);
            
            const actionBtns = document.getElementById('modalActionBtns');
            if (currentNFT.status === 'listed') {
                actionBtns.innerHTML = `
                    <button class="vx-action-btn primary" onclick="buyNFT('${nftId}')" data-testid="button-modal-buy">
                        <i class="bi bi-cart me-2"></i>Buy Now for ${currentNFT.price} ${currentNFT.currency || 'ETH'}
                    </button>
                `;
            } else if (currentNFT.status === 'auction') {
                actionBtns.innerHTML = `
                    <button class="vx-action-btn primary" onclick="placeBid('${nftId}')" data-testid="button-modal-bid">
                        <i class="bi bi-hammer me-2"></i>Place Bid
                    </button>
                `;
            } else {
                actionBtns.innerHTML = `
                    <div class="alert alert-secondary mb-0">This artwork is not currently for sale</div>
                `;
            }
            
            document.getElementById('shareLink').value = window.location.href;
            
            document.getElementById('artworkModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }
        
        function closeArtworkModal() {
            document.getElementById('artworkModal').style.display = 'none';
            document.body.style.overflow = '';
            window.history.pushState({}, '', '/marketplace');
            currentNFT = null;
        }
        
        function toggleModalLike() {
            if (currentNFT) {
                toggleLike(currentNFT._id);
                const isLiked = likedNFTs.includes(currentNFT._id);
                const likeBtn = document.getElementById('modalLikeBtn');
                likeBtn.innerHTML = `<i class="bi bi-heart${isLiked ? '-fill' : ''} me-1"></i> <span id="modalLikeCount">${currentNFT.likes || 0}</span>`;
                likeBtn.classList.toggle('btn-danger', isLiked);
                likeBtn.classList.toggle('btn-outline-danger', !isLiked);
            }
        }
        
        async function incrementViews(nftId) {
            try {
                await fetch(`/api/marketplace/nfts/${nftId}/view`, { method: 'POST' });
            } catch (err) {
                console.error('View increment error:', err);
            }
        }
        
        async function buyNFT(nftId) {
            const nft = allNFTs.find(n => n._id === nftId);
            if (!nft) return;
            
            const sessionRes = await fetch('/api/auth/session');
            const session = await sessionRes.json();
            
            if (!session.authenticated) {
                const loginResult = await Swal.fire({
                    icon: 'warning',
                    title: 'Login Required',
                    text: 'You need to login to purchase NFTs. Go to login page?',
                    showCancelButton: true,
                    confirmButtonText: 'Go to Login',
                    cancelButtonText: 'Cancel',
                    confirmButtonColor: '#3b82f6'
                });
                if (loginResult.isConfirmed) {
                    window.location.href = '/dashboard';
                }
                return;
            }
            
            const result = await Swal.fire({
                icon: 'question',
                title: 'Confirm Purchase',
                text: `Are you sure you want to buy "${nft.name}" for ${nft.price} ${nft.currency || 'ETH'}?`,
                showCancelButton: true,
                confirmButtonText: 'Buy Now',
                cancelButtonText: 'Cancel',
                confirmButtonColor: '#3b82f6'
            });
            if (!result.isConfirmed) return;
            
            try {
                const res = await fetch(`/api/marketplace/nfts/${nftId}/buy`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (!res.ok) {
                    const error = await res.json();
                    throw new Error(error.message || 'Purchase failed');
                }
                
                const purchaseResult = await res.json();
                await Swal.fire({
                    icon: 'success',
                    title: 'Success',
                    text: `Congratulations! You now own "${nft.name}". The artwork has been transferred to your collection.`,
                    confirmButtonColor: '#3b82f6'
                });
                
                closeArtworkModal();
                loadMarketplaceData();
            } catch (err) {
                await Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: err.message || 'Failed to complete purchase. Please try again.',
                    confirmButtonColor: '#3b82f6'
                });
            }
        }
        
        async function placeBid(nftId) {
            const { value: bidAmount } = await Swal.fire({
                icon: 'question',
                title: 'Place Bid',
                input: 'text',
                inputLabel: 'Enter your bid amount (ETH):',
                inputPlaceholder: 'e.g., 1.5',
                showCancelButton: true,
                confirmButtonText: 'Submit Bid',
                cancelButtonText: 'Cancel',
                confirmButtonColor: '#3b82f6'
            });
            if (!bidAmount) return;
            
            await Swal.fire({
                icon: 'info',
                title: 'Bid Placed',
                text: `Your bid of ${bidAmount} ETH has been submitted. You will be notified if you win!`,
                confirmButtonColor: '#3b82f6'
            });
        }
        
        function navigateToArtwork(nftId) {
            document.getElementById('searchDropdown').classList.remove('show');
            window.location.href = `artwork.html?id=${nftId}`;
        }
        
        function copyShareLink() {
            const input = document.getElementById('shareLink');
            input.select();
            document.execCommand('copy');
            Swal.fire({
                icon: 'success',
                title: 'Copied!',
                text: 'Link copied to clipboard',
                timer: 1500,
                showConfirmButton: false
            });
        }
        
        function checkURLForArtwork() {
            const params = new URLSearchParams(window.location.search);
            const nftId = params.get('nft');
            if (nftId) {
                setTimeout(() => openArtworkModal(nftId), 500);
            }
        }
        
        function openAuctionDetail(auctionId) {
            const auction = allAuctions.find(a => a._id === auctionId);
            if (!auction) return;
            
            placeBid(auction.nftId);
        }
        
        setInterval(() => {
            renderAuctions();
        }, 1000);
    </script>
</body>
</html>
